import{c as pe,a as ge,b as be,u as fe,d as ye,e as R,f as x,g as we,R as C,j as n,M as _,h as e,i as I,k as N,l as j,m as H,n as B,V as T,I as U,H as v,T as p,L as Se,o as Ce,F as M,A,p as ke,q as ie,r as w,s as ve,t as Re,v as Z,w as Ae,x as Me,y as Le,z as S,B as K,C as ze,D as Pe,E as Q,G as Ee,J as Te,K as Oe,N as De,S as xe,O as _e,P as Ie,Q as O,U as G,W as oe,X as Ne,Y as $,Z as le,_ as je,$ as D,a0 as He,a1 as Be,a2 as ce,a3 as X,a4 as Ue,a5 as Ge,a6 as $e,a7 as P,a8 as E,a9 as Fe,aa as We,ab as Ve,ac as Ye,ad as qe,ae as Je,af as Ze,ag as Ke,ah as Qe,ai as Xe,aj as et,ak as tt,al as at,am as ee,an as te,ao as ae,ap as nt,aq as rt,ar as st,as as it,at as ot}from"./vendor-23031baf.js";function Bt(){import.meta.url,import("_").catch(()=>1);async function*l(){}}(function(){const i=document.createElement("link").relList;if(i&&i.supports&&i.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))t(r);new MutationObserver(r=>{for(const a of r)if(a.type==="childList")for(const u of a.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&t(u)}).observe(document,{childList:!0,subtree:!0});function d(r){const a={};return r.integrity&&(a.integrity=r.integrity),r.referrerPolicy&&(a.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?a.credentials="include":r.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function t(r){if(r.ep)return;r.ep=!0;const a=d(r);fetch(r.href,a)}})();const lt={gallery:{shanghai:{contributors:["3353040"],name:{en:"Shanghai","zh-Hans":"上海","zh-Hant":"上海"},lastUpdateOn:1683810518708}}},de=pe({name:"app",initialState:lt,reducers:{setGallery:(l,i)=>{l.gallery=i.payload}}}),{setGallery:ct}=de.actions,dt=de.reducer,ht=ge(),he=be({reducer:{app:dt},middleware:l=>l().prepend(ht.middleware)}),ut=()=>fe(),F=ye;window.rmgStore=he;var W=(l=>(l.APP_LOAD="APP_LOAD",l.UPLOAD_TEMPLATES="UPLOAD_TEMPLATES",l))(W||{});const mt="Hi RMP team! I would like to contribute to the gallery with the data below.",pt="**Do not edit lines below, they are meant for bots only!!!**";function V(){const{i18n:l}=R();return i=>{var d,t;return(t=(d=l.languages.map(r=>i[r]).find(r=>r!==void 0))!=null?d:i.en)!=null?t:"(Translation Error)"}}const gt="RMP_GALLERY_CHANNEL",bt="OPEN_TEMPLATE",ft=new BroadcastChannel(gt),yt=l=>{const{city:i,isOpen:d,onClose:t}=l,r=x(),a=we(),{t:u}=R(),k=V();F(b=>b.app.gallery);const[o,h]=C.useState({name:{en:""},desc:{en:""},reference:"",updateHistory:[]});C.useEffect(()=>{fetch(`resources/metadata/${i}.json`).then(b=>b.json()).then(b=>h({...b,justification:""}))},[i]);const f=()=>r("/new",{state:{metadata:o}}),s=()=>{ft.postMessage({event:bt,data:i}),a({title:u(`Template ${i} imported in Rail Map Painter.`),status:"success",duration:9e3,isClosable:!0})},g=`https://${window.location.hostname}/rmp/s/${i}`,z={title:u("Link copied."),status:"success",duration:9e3,isClosable:!0};return n(_,{isOpen:d,onClose:t,size:"6xl",scrollBehavior:"inside",children:[e(I,{}),n(N,{children:[e(j,{children:u("Details")}),e(H,{}),n(B,{paddingBottom:10,children:[e(T,{children:e("a",{href:`resources/thumbnails/${i}.png`,target:"_blank",rel:"noopener noreferrer",children:e(U,{src:`resources/thumbnails/${i}.png`,alt:i,borderRadius:"lg"})})}),e(v,{as:"h5",size:"md",mt:3,mb:2,children:k(o.name)}),e(p,{children:k(o.desc)}),e(v,{as:"h5",size:"sm",mt:3,mb:2,children:u("Update History")}),e(Se,{children:o.updateHistory.map(b=>e(Ce,{children:n(M,{flexDirection:"row",alignItems:"center",children:[e(A,{size:"sm",mr:"2",src:`https://avatars.githubusercontent.com/u/${b.id}`,cursor:"pointer",onClick:()=>fetch(`https://api.github.com/user/${b.id}`).then(L=>L.json()).then(L=>window.open(`https://github.com/${L.login}`))}),e(ke,{mr:"auto",href:`https://github.com/railmapgen/rmp-gallery/issues/${b.issueNumber}`,isExternal:!0,children:b.reason}),e(p,{children:new Date(b.time).toLocaleString(void 0,{hour12:!1})})]})},b.id))})]}),n(ie,{children:[e(w,{"aria-label":"Like",variant:"ghost",icon:e(ve,{}),isDisabled:!0}),e(w,{"aria-label":"Favorite",variant:"ghost",icon:e(Re,{}),isDisabled:!0}),e(Z,{label:g,children:e(w,{"aria-label":"Share",variant:"ghost",icon:e(Ae,{}),onClick:()=>{navigator.clipboard.writeText(g),a(z)}})}),e(w,{"aria-label":"Edit",variant:"ghost",icon:e(Me,{}),onClick:f}),e("a",{href:`resources/real_world/${i}.json`,target:"_blank",rel:"noopener noreferrer",children:e(w,{"aria-label":"Download",variant:"ghost",icon:e(Le,{})})}),S.isStandaloneWindow()?e(Z,{label:"You may directly use this template if your are in Rail Map Painter or Rail Map Toolkit",children:e(w,{"aria-label":"Import",variant:"ghost",icon:e(K,{}),isDisabled:!0})}):e(w,{"aria-label":"Import",variant:"ghost",icon:e(K,{}),onClick:s})]})]})]})};function wt(){const l=x(),i=ut(),d=V(),{t}=R(),{gallery:r}=F(s=>s.app),a=()=>{l("/new",{state:{metadata:{name:{en:""},desc:{en:""},reference:"",justification:""}}}),S.event(W.UPLOAD_TEMPLATES,{})},[u,k]=C.useState("shanghai"),[o,h]=C.useState(!1),f=s=>{h(!0),k(s)};return C.useEffect(()=>{fetch("resources/real_world.json").then(s=>s.json()).then(s=>i(ct(s)))},[]),n(ze,{isLazy:!0,isFitted:!0,children:[n(Pe,{children:[e(Q,{children:t("gallery.type.realWorld")}),e(Q,{isDisabled:!0,children:t("gallery.type.fantasy")})]}),e(Ee,{children:n(Te,{children:[n(M,{flexWrap:"wrap",children:[Object.keys(r).map(s=>n(Oe,{variant:"elevated",minWidth:"300",m:"2",children:[n(De,{children:[e(U,{src:`resources/thumbnails/${s}@300.png`,alt:s,borderRadius:"lg"}),e(xe,{mt:"6",spacing:"3",children:e(v,{size:"lg",children:d(r[s].name)})})]}),n(_e,{children:[e(Ie,{max:3,children:r[s].contributors.map(g=>e(A,{src:`https://avatars.githubusercontent.com/u/${g}`},g))}),e(O,{variant:"solid",colorScheme:"blue",ml:"auto",onClick:()=>f(s),children:t("Details")})]})]},s)),e(G,{onClick:a,position:"fixed",bottom:"20px",right:"20px",zIndex:3,children:e(w,{"aria-label":"new",size:"lg",icon:e(oe,{}),colorScheme:"blue",variant:"solid"})})]}),e(yt,{city:u,isOpen:o,onClose:()=>h(!1)})]})})]})}const St=l=>new Promise(i=>{const d=new FileReader;d.onloadend=()=>i(d.result),d.readAsText(l)}),ne=(l,i,d)=>{if(i!==null){const t=document.createElement("details");return t.setAttribute("repo","rmp-gallery"),t.setAttribute("type",l),Object.entries(d).forEach(([r,a])=>{t.setAttribute(r,a)}),t.textContent=i,t.outerHTML}else return""},Ct={"& > div:first-of-type":{flex:1}};function re(l){const{translations:i,onUpdate:d,onLangSwitch:t,onRemove:r}=l,{t:a}=R(),u=V(),k=(h,f)=>[{type:"select",label:a("Language"),value:h,options:Object.entries(D).reduce((s,g)=>({...s,[g[0]]:u(g[1])}),{}),disabledOptions:i.filter(s=>s[0]!==h).map(s=>s[0]),onChange:s=>t(h,s)},{type:"input",label:a("Name"),value:f,onChange:s=>d(h,s),validator:s=>!!s}],o=()=>{const h=Object.keys(D).filter(f=>!i.find(s=>s[0]===f))[0];d(h,"")};return e(Ne,{direction:"column",children:i.map(([h,f],s,g)=>n($,{sx:Ct,children:[e(le,{fields:k(h,f),noLabel:s>0}),s===g.length-1?e(w,{size:"sm",variant:"ghost","aria-label":a("Add a name in another language"),title:a("Add a name in another language"),onClick:o,icon:e(oe,{})}):e(G,{minW:8}),g.length>1&&e(w,{size:"sm",variant:"ghost","aria-label":a("Remove this name"),title:a("Remove this name"),onClick:()=>r(h),icon:e(je,{})})]},s))})}const kt={px:2,pt:2,width:{base:"100%",md:520},"& > div:first-of-type":{flexDirection:"column",flex:1,overflowY:"auto"},"& > div:nth-of-type(2)":{my:2}};function vt(){var Y,q;const{state:{metadata:l}}=He(),i=x(),d=F(c=>c.app.gallery),{t}=R(),r=()=>i("/"),a=C.useRef(null),[u,k]=C.useState(!1),[o,h]=C.useState(l),[f,s]=C.useState(""),g=(q=(Y=o.name.en)==null?void 0:Y.replace(/[^A-Za-z0-9]/g,"").toLowerCase())!=null?q:"",z=[mt,pt,ne("metadata",JSON.stringify(o,null,4),{}),ne("real_world",f,{compress:"zipson",city:g})].join(`

`),b=new URLSearchParams({labels:"resources",title:`Resources: ${g in d?"Update":"New"} template of ${g}`}),L=async c=>{var y;const m=(y=c.target.files)==null?void 0:y[0];if(console.log("handleFileUpload():: received file",m),!!m){if(m.type!=="application/json"){alert("Invalid file type!"),c.target.value="";return}try{const J=await St(m);s($e.stringify(JSON.parse(J.trim())).trim())}catch(J){alert("Invalid file!"),c.target.value=""}}},ue=async()=>{a!=null&&a.current&&(a.current.select(),await navigator.clipboard.writeText(z)),window.open("https://github.com/railmapgen/rmp-gallery/issues/new?"+b.toString(),"_blank")},me=[{type:"custom",label:t("Project file"),component:e(Be,{variant:"flushed",size:"xs",type:"file",accept:".json",onChange:L}),minW:250},{type:"input",label:t("Reference link"),placeholder:"Enter the link where you get the valid data",value:o.reference,onChange:c=>h({...o,reference:c}),minW:250},{type:"input",label:t("Justification"),placeholder:"The reason why you make these changes",validator:c=>/^[a-zA-Z0-9. -]+$/.test(c),value:o.justification,onChange:c=>h({...o,justification:c}),minW:250}];return n(ce,{sx:kt,children:[n(M,{children:[e(le,{fields:me}),e(X,{label:t("City Name"),children:e(re,{translations:Object.entries(o.name),onUpdate:(c,m)=>h({...o,name:{...o.name,[c]:m}}),onLangSwitch:(c,m)=>{const y=structuredClone(o);y.name[m]=y.name[c],delete y.name[c],h(y)},onRemove:c=>{const m=structuredClone(o);delete m.name[c],h(m)}})}),e(X,{label:t("Description (Optional)"),children:e(re,{translations:Object.entries(o.desc),onUpdate:(c,m)=>h({...o,desc:{...o.desc,[c]:m}}),onLangSwitch:(c,m)=>{const y=structuredClone(o);y.desc[m]=y.desc[c],delete y.desc[c],h(y)},onRemove:c=>{const m=structuredClone(o);delete m.desc[c],h(m)}})})]}),n(M,{children:[e(O,{size:"sm",onClick:r,children:t("Back to list")}),e($,{ml:"auto",children:e(O,{size:"sm",colorScheme:"primary",isDisabled:f===""||o.reference===""||o.justification===""||!/^[a-zA-Z0-9. -]+$/.test(o.justification)||g==="",onClick:()=>k(!0),children:t("Submit")})})]}),n(_,{isOpen:u,onClose:()=>k(!1),children:[e(I,{}),n(N,{children:[e(j,{children:t("Submit template")}),e(H,{}),n(B,{children:[e(p,{children:t("You may now copy the following text into your new issue's body.")}),e(Ue,{mt:"2",mb:"2"}),e(Ge,{ref:a,isReadOnly:!0,defaultValue:z,onClick:({target:c})=>c.select()})]}),e(ie,{children:e(O,{colorScheme:"primary",onClick:ue,children:t("Copy issue body and open a new issue")})})]})]})]})}const Rt="/rmp-gallery/assets/github-mark-7a0dd11e.svg",At="/rmp-gallery/assets/slack-mark-19839006.svg",Mt=l=>{const{isOpen:i,onClose:d}=l,{t}=R(),r=S.getAppVersion();return n(_,{isOpen:i,onClose:d,size:"xl",scrollBehavior:"inside",children:[e(I,{}),n(N,{children:[e(j,{children:t("header.about.title")}),e(H,{}),n(B,{paddingBottom:10,children:[n(M,{direction:"row",children:[e(U,{boxSize:"128px",src:"/rmp-gallery/logo192.png"}),n(M,{direction:"column",width:"100%",alignItems:"center",justifyContent:"center",children:[e(p,{fontSize:"xl",as:"b",children:t("header.about.rmpGallery")}),e(p,{children:r}),e(p,{}),e(p,{fontSize:"sm",children:t("header.about.railmapgen")})]})]}),e(G,{margin:5,children:e(p,{fontSize:"xl",children:t("header.about.desc")})}),e(v,{as:"h5",size:"sm",mt:3,mb:2,children:t("header.about.contributors")}),e(v,{as:"h6",size:"xs",my:2,children:t("header.about.coreContributors")}),e(T,{children:n(P,{size:"lg",w:"85%",onClick:()=>window.open("https://github.com/thekingofcity","_blank"),cursor:"pointer",children:[e(A,{src:"https://github.com/thekingofcity.png",size:"lg",my:2,ml:-1,mr:2}),n(E,{display:"block",width:"100%",children:[e(p,{fontSize:"lg",fontWeight:"bold",mb:1,children:"thekingofcity"}),e(p,{fontSize:"sm",children:t("header.about.content1")}),e(p,{fontSize:"sm",align:"right",mb:1,children:t("header.about.content2")})]})]})}),e(v,{as:"h6",size:"xs",my:2,children:t("header.about.templateAdministrators")}),e(T,{children:["52PD","linchen1965"].map(a=>n(P,{size:"lg",w:"85%",onClick:()=>window.open(`https://github.com/${a}`,"_blank"),cursor:"pointer",children:[e(A,{src:`https://github.com/${a}.png`,size:"lg",my:2,ml:-1,mr:2}),n(E,{display:"block",width:"100%",children:[e(p,{fontSize:"lg",fontWeight:"bold",mb:1,children:a}),e(p,{fontSize:"sm",mb:1,children:t(`header.about.${a}`)})]})]},a))}),e(v,{as:"h5",size:"sm",mt:3,mb:2,children:t("header.about.contactUs")}),n(T,{children:[n(P,{size:"lg",w:"85%",onClick:()=>window.open("https://github.com/railmapgen/rmp-gallery/issues","_blank"),cursor:"pointer",children:[e(A,{src:Rt,size:"lg",my:2,ml:-1,mr:2}),n(E,{display:"block",width:"100%",children:[e(p,{fontSize:"lg",fontWeight:"bold",mb:1,children:t("header.about.github")}),e(p,{fontSize:"sm",children:t("header.about.githubContent")})]})]}),n(P,{size:"lg",w:"85%",onClick:()=>window.open("https://join.slack.com/t/railmapgenerator/shared_invite/zt-1odhhta3n-DdZF~fnVwo_q0S0RJmgV8A","_blank"),cursor:"pointer",children:[e(A,{src:At,size:"lg",my:2,ml:-1,mr:2}),n(E,{display:"block",width:"100%",children:[e(p,{fontSize:"lg",fontWeight:"bold",mb:1,children:t("header.about.slack")}),e(p,{fontSize:"sm",children:t("header.about.slackContent")}),e(p,{fontSize:"sm",as:"i",children:"#rmg, #rmp, #gallery, #random"})]})]})]})]})]})]})};function Lt(){const{t:l}=R(),i=S.getEnv(),d=S.getAppVersion(),[t,r]=C.useState(!1),a=u=>{S.setLanguage(u),S.getI18nInstance().changeLanguage(u)};return n(Fe,{children:[e(v,{as:"h4",size:"md",children:l("header.about.rmpGallery")}),e(We,{environment:i,version:d}),n($,{ml:"auto",children:[n(Ve,{children:[e(Ye,{as:w,icon:e(qe,{}),variant:"ghost",size:"sm"}),e(Je,{children:Ze.map(u=>e(Ke,{onClick:()=>a(u),children:D[u][u]},u))})]}),e(w,{size:"sm",variant:"ghost","aria-label":"Help",icon:e(Qe,{}),onClick:()=>r(!0)})]}),e(Mt,{isOpen:t,onClose:()=>r(!1)})]})}function zt(){return e(Xe,{basename:"/rmp-gallery/",children:e(et,{children:n(tt,{children:[e(Lt,{}),e(ce,{children:n(at,{children:[e(ee,{path:"/",element:e(te,{suspenseFallback:e(ae,{isIndeterminate:!0}),children:e(wt,{})})}),e(ee,{path:"/new",element:e(te,{suspenseFallback:e(ae,{isIndeterminate:!0}),children:e(vt,{})})})]})})]})})})}const Pt={about:{rmpGallery:"RMP Gallery",title:"About",railmapgen:"A railmapgen project",desc:"Browse, set, and submit your RMP template here!",content1:"In memory of all the freedom and equality we once had.",content2:"06/01/2022 in Shanghai",contributors:"Contributors",coreContributors:"Core Contributors",templateAdministrators:"Administrators","52PD":"Special thanks for his continuous effort in maintaining templates.",linchen1965:"Special thanks for his continuous effort in maintaining templates.",contactUs:"Contact Us",github:"Project Repository",githubContent:"Face any problems? Search or raise an issue here!",slack:"Slack Group",slackContent:"Chat in these Slack channels!"}},Et={type:{realWorld:"Real World",fantasy:"Fantasy"}},Tt={header:Pt,gallery:Et},Ot={about:{rmpGallery:"RMP画廊",title:"About",railmapgen:"一个railmapgen项目",desc:"浏览、设置、提交你制作的RMP模板！",content1:"谨以此纪念我们曾拥有的自由与平等。",content2:"06/01/2022于上海",contributors:"贡献者",coreContributors:"核心贡献者",templateAdministrators:"管理员","52PD":"特别感谢他维护这些模板的持续付出。",linchen1965:"特别感谢他维护这些模板的持续付出。",contactUs:"联系我们",github:"项目仓库",githubContent:"遇到任何问题？在这里搜索或提出一个问题！",slack:"Slack群组",slackContent:"在这些Slack频道中讨论!"}},Dt={header:Ot},xt={about:{rmpGallery:"RMP畫廊",title:"關於",railmapgen:"一個railmapgen項目",desc:"瀏覽、設置、提交你製作的RMP模板！",content1:"謹以此紀念我們曾擁有的自由與平等。",content2:"06/01/2022於上海",contributors:"貢獻者",coreContributors:"核心貢獻者",templateAdministrators:"管理員","52PD":"特別感謝他維護這些模板的持續付出。",linchen1965:"特別感謝他維護這些模板的持續付出。",contactUs:"聯繫我們",github:"項目倉庫",githubContent:"遇到任何問題？在這裡搜索或提出一個問題！",slack:"Slack群組",slackContent:"在這些Slack頻道中討論!"}},_t={header:xt},It={about:{rmpGallery:"RMP 갤러리",title:"대함",railmapgen:"railmapgen 프로젝트",desc:"Browse, set, and submit your RMP template here!",content1:"우리가 가졌던 자유와 평등을 기념한다.",content2:"2022년 6월 1일 상해",contributors:"기여자",coreContributors:"핵심 기여자",templateAdministrators:"Administrators","52PD":"Special thanks for his continuous effort in maintaining templates.",linchen1965:"Special thanks for his continuous effort in maintaining templates.",contactUs:"우리에게 연락하기",github:"프로젝트 저장소",githubContent:"무슨 문제라도 있나요? 여기서 문제를 검색하거나 제기하십시오!",slack:"슬랙 그룹",slackContent:"이 슬랙 채널에서 채팅해요!"}},Nt={header:It},jt=new S.I18nBuilder().use(nt).withAppName("RMP Gallery").withLng(S.getLanguage()).withResource("en",Tt).withResource("zh-Hans",Dt).withResource("zh-Hant",_t).withResource("ko",Nt).build();let se;const Ht=()=>{se=rt(document.getElementById("root")),se.render(e(st.StrictMode,{children:e(it,{store:he,children:e(ot,{i18n:jt,children:e(zt,{})})})}))};S.ready().then(()=>{Ht(),S.injectCss(),S.event(W.APP_LOAD,{})});export{Bt as __vite_legacy_guard};
